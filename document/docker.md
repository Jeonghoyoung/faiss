# Docker

도커는 Linux 컨테이너를 만들고 사용할 수 있도록 하는 컨테이너화 기술이다.
* Linux 컨테이너 : 시스템의 나머지 부분과 분리된 1개 이상의 프로세스 세트. 

		(1) 도커를 사용하면 컨테이너를 매우 가벼운 모듈식 가상머신처럼 다룰수 있고 컨테이너를 구축, 배포, 복사하고 한 환경에서 다른 환경으로 이동하는 등 유연하게 사용할 수 있다.

		(2) 도커는 여러 프로세스와 어플리케이션을 서로 개별적으로 실행하여 인프라를 더 효과적으로 활용하고 개별 시스템을 사용할 때와 동일한 보안을 유지할 수 있다.


		(3) 도커는 리눅스 컨테이너와 달리 컨테이너를 실행하는 기능 이상의 것을 제공하며 컨테이너 생성 및 구축, 이미지 전송, 이미지 버전 관리 프로세스를 용이하게 해줍니다.


	도커 장점:
	1. 모듈성 : 컨테이너화 접근 방식은 전체 어플리케이션을 분해할 필요 없이 어플리케이션의 일부를 분해, 업데이트 또는 복구하는 능력에 집중되어 있어, 멀티플 어플리케이션 사이에서 프로세스를 공유할 수 있다.

	2. 계층 및 이미지 버전 제어 : 각 도커 이미지 파일은 일련의 계층으로 이루어져 있으며 이 계층들은 단일 이미지로 결합된다. 
							이미지가 변경될 때 계층이 생성, 사용자가 실행 또는 복사와 같은 명령을 지정할 때마다 새 계층이 생성된다.
							중간 변경 사항이 이미지 사이에서 공유되므로 속도, 규모, 효율성이 더 개선 됨.
							계층화에는 버전 관리가 내재되어 있으며 새로운 변경 사항이 발생할 때마다 내장 변경 로그가 기본적으로 적용되므로 컨테이너 이미지를 완전히 제어할 수 있다.

	3. 롤백 : 모든 이미지에는 계층이 있으므로, 현재의 이미지 반복이 적절하지 않은 경우 이전 버전으로 롤백할 수 있다. 이는 지속적인 통합 및 연속 배포를 수행하는데 도움을 준다.

	4. 신속한 배포 : 도커는 각 프로세스에 대한 컨테이너를 생성함으로써 사용자는 유사한 프로세스를 새 앱과 빠르게 공유할 수 있다. 또한, 컨테이너를 추가하거나 이동하기 위해 OS를 부팅할 필요 없으므로,배포 시간이 크게 단축된다.
	이뿐 아니라, 배포 속도가 빨라 컨테이너에서 생성된 데이터를 비용 효율적으로 쉽게 생성하고 삭제할수 있고 사용자는 우려할 필요가 없다.

	즉, 도커 기술은 효율성을 중시하며 더 세분화되고 제어 가능한 마이크로서비스 기반 접근 방식이다.


	컨테이너 특징:
	1. 서버에 여러 컨테이너를 실행하면 독립적으로 실행되어 가상머신을 사용하는 느낌을 준다.
	2. 실행중인 컨테이너에 접속하여 명령어를 입력할 수 있다.
	3. apt-get 이나 brew , yum 등 운영체제에서 사용하는 패키지 매니저를 통해 설치할 수 있고 사용자도 추가하고 프로세스를 백그라운드로 실행할 수 있다.
	3. CPU나 메모리 사용량을 제한할 수 있다.
	4. 호스트의 특정 포트와 연결 혹은 호스트의 특정 디렉토리를 내부 디렉토리인 것처럼 사용 가능

			이미지 : 컨테이너 실행에 필요한 파일과 설정을 포함하고 있는 것으로 상태값을 가지지 않고 변하지 않는다.
			(1) 추가되거나 변하는 값은 컨테이너에 저장된다.
			(2) 같은 이미지에서 여러개의 컨테이너를 만들 수 있고 컨테이너의 상태가 바뀌거나 삭제되어도 이미지는 변하지 않는다.

			(3) 도커 이미지는 Docker hub에 등록하거나 Docker Registry 저장소를 직접 만들어 관리할 수 있다.

		이미지 특징:
		1. 도커 이미지의 용량은 보통 수백 MB ~ 수 GB이다.
		2. 상태값을 가지지 않고 변하지 않는다.
		3. 하나의 이미지를 통해 여러 컨테이너를 생성할 수 있고, 컨테이너를 삭제해도 이미지는 변하지 않는다.
		4. 이미지들은 Docker hub를 통해 버전 관리 및 배포가 가능하다.
		5. 도커는 Dockerfile 이라는 파일로 이미지를 만든다.

	Dockerfile: 도커 이미지를 만들기 위해 Dockerfile 이라는 파일에 DSL(Domain Specific Language) 언어를 이용해 이미지를 생성할 수 있다. 
	- 단순 텍스트 파일로 일반적으로 소스와 함께 관리하며, 서버에서 프로그램을 설치할때, Dockerfile을 통하여 관리할 수 있다.
	- Dockerfile에서 사용할 수 있는 키워드는 20개 정도 이며, 여기서 중요한건 이미지를 만드는 FROM 과 RUN이다.

			FROM<image>:<tag>
			FROM ubuntu:16.04
			-> 베이스 이미지를 지정하는것으로 반드시 베이스 이미지를 지정해야 하며 어떠한 이미지도 베이스 이미지가 될 				수 있다.
			-> tag는 버전을 지정하는 것으로 가능하면 구체적인 버전을 지정하는 것이 좋다.

			RUN <command>
			RUN bundle install
			-> 가장 많이 사용하는 구문 중 하나로 명령어를 실행하는것이다.


		Docker 명령어 : docker run [OPTIONS] IMAGE[:TAG|@DOGEST] [COMMAND] [ARG..]

		주로 사용되는 옵션

			-d : detached mode 흔히 말하는 백그라운드 모드 
			-p : 호스트와 컨테이너의 포트를 연결 (포워딩)
			-v : 호스트와 컨테이너의 디렉토리를 연결 (마운트)
			-e : 컨테이너 내에서 사용할 환경변수 설정
			-name : 컨테이너 이름 설정
			-rm : 프로세스 종료시 컨테이너 자동 제거
			-it : -i와 -t를 동시에 사용한 것으로 터미널 입력을 위한 홉션
			-link : 컨테이너 연결 [컨테이너명: 별칭]

			ex) docker run --rm -it ubuntu:16.04 /bin/bash
			-> 컨테이너 내부에 들어가기 위해 뒤에 /bin/bash 를 붙이고 키보드 입력을 위해 -it, 프로세스가 종료되면 			컨테이너가 자동 삭제되도록 --rm 옵션

	컨테이너 명령어:

		ps : 실행중인 컨테이너 목록을 보여준다. 
			-a 옵션 : 종료된 컨테이너까지 목록으로 보여주며 컨테이너는 종료되어도 삭제되지 않고 남아있다.
			ex) doker ps [OPTIONS]
		stop : 실행중인 컨테이너를 중지하는 명령어, 컨테이너를 하나 또는 그 이상을 중지할 수 있다(띄어쓰기로 구분).
			ex) docker stop [OPTIONS] CONTAINER

		rm : 종료된 컨테이너를 제거하는 명령어, 종료된 컨테이너를 하나 또는 여러개 삭제 할 수 있다.
			ex) docker rm [OPTIONS] CONTAINER
		logs : 컨테이너가 정상적으로 동작하는지 확인하는 좋은 방법.
			ex) docker logs [OPTIONS] CONTAINER
			--tail : 마지막 줄부터 몇 줄을 출력할지 설정할 수 있다.
			-f : 실시간으로 생성되는 로그를 볼 수 있다.
		exec : 실행중인 컨테이너에 들어가보거나 컨테이너 파일을 실행하고 싶을때 사용한다.
			ex) docker exec [OPTIONS] CONTAINER COMMAND [ARG...]

	이미지 명령어:

		images : 도커가 다운로드한 이미지 목록을 보는 명령어
			ex) docker images [OPTIONS] [REPOSITORY[:TAG]]

		pull : 이미지를 다운로드 하는 명령어
			- run 명령어를 입력하면 이미지가 없을때 자동 다운이 된다. 
			- pull 명령어는 최신버전을 다운로드 할 경우 사용된다.
			ex) docker pull [OPTIONS] NAME[:TAG|@DIGSET]
			
		rmi : 이미지를 삭제하는 명령어
			- 컨테이너가 실행중인 이미지는 삭제되지 않는다.
			ex) docker rmi [OPTIONS] IMAGE [IMAGE...]
	
